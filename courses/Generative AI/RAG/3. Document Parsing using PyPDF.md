# 3. Document Parsing using PyPDF

## **What is PyPDF?**

**PyPDF** is a Python library for handling PDF files. It allows you to read, write, merge, split, rotate, and extract text from PDF documents with ease. For AI-powered pipelines, PyPDF is often used to extract textual content from documents as input for further downstream processes like **semantic search**, **document analysis**, or **contextual parsing in RAG systems**.

PyPDF is a lightweight and efficient library with capabilities such as:

1. **Text Extraction**: Extract plain text from pages of a PDF file.
2. **Page Manipulation**: Rotate, merge, or split PDF pages programmatically.
3. **Metadata Handling**: Access and modify PDF metadata like titles, authors, and creation dates.

---

## **Why Parse PDF Documents?**

PDF parsing is often necessary for:

- **Text Extraction**: Converting the content of PDFs (like contracts, invoices, reports) into editable formats for analysis or input into ML/NLP pipelines.
- **Context Capture**: Enabling document understanding with contextual information (e.g., for chatbots or RAG systems).
- **Content Restructuring**: Extracting specific sections, headings, tables, or other patterns of interest for use in other applications.

---

## **Core Features of PyPDF**

Here’s a high-level breakdown of PyPDF features useful for PDF parsing:

1. Extract **text** from PDFs.
2. Read specific **pages** only, reducing processing time.
3. Handle **encrypted PDFs** (if you have the password).
4. Parse **metadata** for document-level information.
5. Merge or split PDFs programmatically.

---

## **Installation**

You can install **PyPDF** using the following command:

```bash
! pip install pypdf --quiet
```

---

## **Text Extraction with PyPDF**

Let’s jump straight into the most common use case: **text extraction**.

### **Basic Example: Extracting All Text from a PDF**

```python
from pypdf import PdfReader

# Load the PDF document
pdf_path = "sample-local-pdf.pdf"
reader = PdfReader(pdf_path)

# Extract text from all pages
for i, page in enumerate(reader.pages):
    text = page.extract_text()
    print(f"--- Page {i + 1} ---")
    print(text)

```

### **Output:**

```
--- Page 1 ---
Welcome to PyPDF Parsing!
This is an example of extracting text. You now have everything you need to parse PDFs.

```

**How It Works**:

- **`PdfReader`** loads the PDF.
- **`reader.pages`** gives you all the pages as an iterable.
- **`page.extract_text()`** extracts the text content of each page.

---

## **Page-Wise Parsing**

If your PDF is large, you might only be interested in extracting specific page ranges. Here’s how:

```python
from pypdf import PdfReader

# Load the PDF document
reader = PdfReader("sample-local-pdf.pdf")

# Extract text from specific pages (e.g., pages 1 and 2 only)
selected_pages = [0, 1]  # Page indices (0-based)
for i in selected_pages:
    text = reader.pages[i].extract_text()
    print(f"--- Page {i + 1} ---")
    print(text)

```

### **Use Case:**

- Great for PDFs where only key sections (e.g., summaries or appendices) are relevant.

---

## **Extracting Metadata**

You can retrieve document-level information, such as the title, author, or creation date, using **metadata attributes**.

```python
from pypdf import PdfReader

# Load the PDF
reader = PdfReader("sample-local-pdf.pdf")

# Extract metadata
metadata = reader.metadata
print("Title:", metadata.title)
print("Author:", metadata.author)
print("Creator:", metadata.creator)

```

### **Output:**

```
Title: Document Parsing with PyPDF
Author: Jane Doe
Creator: PDF Creator Tool

```

---

## **Combining with Recursive Character Splitting**

For large documents that need to be split into **chunks** for downstream processing (e.g., building RAG pipelines), PyPDF pairs perfectly with tools like **Recursive Character Text Splitter**. Here’s an example workflow:

1. **Extract text** from the PDF using PyPDF.
2. **Split the text** into chunks using a text splitter.

```python
from langchain.text_splitter import RecursiveCharacterTextSplitter
from pypdf import PdfReader

# Step 1: Extract text from the entire document
reader = PdfReader("sample-local-pdf.pdf")
full_text = ""
for page in reader.pages:
    full_text += page.extract_text()

# Step 2: Split the text into manageable chunks
splitter = RecursiveCharacterTextSplitter(chunk_size=512, chunk_overlap=50)
chunks = splitter.split_text(full_text)

# Display the chunks
for i, chunk in enumerate(chunks):
    print(f"Chunk {i + 1}:\\n{chunk}\\n")

```

**Why Combine PyPDF with Chunking?**
This approach allows you to feed **structured text chunks** into AI pipelines like retrieval-augmented generation (RAG) for NLP-driven question answering.

---

## **Handling Encrypted PDFs**

Encrypted PDFs often require a password for access. Here’s how you can handle them with PyPDF:

```python
from pypdf import PdfReader

# Load and decrypt the PDF
reader = PdfReader("encrypted.pdf")
reader.decrypt("your_password")

# Extract text as usual
for page in reader.pages:
    text = page.extract_text()
    print(text)

```

---

## **Advanced Use Cases**

### **1. Extract Tables from PDFs**

While PyPDF doesn’t directly handle tables, you can pair it with **Tabula** or **Camelot** libraries to extract tabular data.

```bash
pip install camelot-py

```

Example:

```python
import camelot

# Extract tables from PDF
tables = camelot.read_pdf("example.pdf", pages="1")
tables[0].to_csv("table.csv")  # Save the first table to CSV

```

### **2. Combine with Semantic Parsing**

You can pair PyPDF with semantic parsing tools to ensure you capture hierarchical structures like headings, subheadings, and sections.

---

## **Advantages of PyPDF**

1. **Simplicity and Ease of Use:** Using PyPDF requires minimal setup and is highly beginner-friendly.
2. **Lightweight:** Unlike some other libraries, PyPDF doesn't impose heavy dependencies.
3. **Open-Source**: Fully community-supported and free to use.
4. **Customizable Workflows**: Can be combined with other tools, like chunking, table extraction, and RAG frameworks.
5. **Multi-Functional:** Use it for not only text extraction but also metadata parsing, merging PDFs, and more.

---

## **Limitations of PyPDF**

1. **Text Extraction Accuracy:** Text layout in complex PDFs (e.g., multi-column layouts) might cause extraction errors.
2. **Lack of Table Parsing:** Direct table extraction isn't supported and often requires external tools like Camelot.
3. **Encoding Issues:** PDFs with non-standard character encodings may result in unreadable text.

---

## **Wrap-Up**

With this powerful tool in your arsenal, PyPDF opens up immense possibilities for working with PDF documents, whether you’re processing them for AI workflows, legal contracts, invoices, or simply extracting knowledge for analysis. By combining PyPDF with other Python libraries, you can unlock the true potential of any PDF!