# 5. Document Parsing Using Azure Document Intelligence

## **What is Azure Document Intelligence?**

Azure Document Intelligence (formerly **Azure Form Recognizer**) is a platform that enables automated extraction of structured and unstructured data from documents. It leverages AI models to understand the inherent structure of documents like:

- Invoices
- Receipts
- Contracts
- Financial statements
- Forms (handwritten or digital)
- Tables

Think of it as turning a pile of printed or scanned documents into **machine-readable, organized** data that you can use for business workflows, automation, or AI.

---

## **Capabilities of Azure Document Intelligence**

Azure Document Intelligence provides a suite of features for various document types. Let’s dive into its key capabilities:

### **1️⃣ Layout Extraction**

- Extracts **basic structural and textual elements** like:
    - Text content
    - Lines
    - Paragraphs
    - Bounding boxes
    - Selection (checkboxes)
- It’s useful for understanding the **spatial layout** of a document or processing the visual structure of forms or PDFs.

**Use Case:**

- Parsing unstructured PDFs to capture their **raw structure** (headings, text blocks).

---

### **2️⃣ Prebuilt Models for Specific Documents**

Microsoft Azure provides pre-trained models for parsing commonly used document types, so you don’t need to train anything from scratch:

| **Prebuilt Model** | **Purpose** |
| --- | --- |
| **Invoices** | Extract invoice details like totals, tax amounts, vendor names, and dates. |
| **Receipts** | Recognizes store names, purchase items, prices, payment methods, etc. |
| **ID Documents (Passports)** | Extracts data fields like names, dates, issuing authorities. |
| **Business Cards** | Pulls contact names, phone numbers, job roles, etc. |

**Use Case:**

- Extracting structured data for accounting workflows from scanned invoices with prebuilt **Invoice Model**.

---

### **3️⃣ Custom Model Training**

For document types that don’t fit into prebuilt categories, you can **train your own models** using labeled datasets. Once trained, these models can:

- Recognize custom fields (like "Policy No." in an insurance form).
- Work with any uniquely formatted document beyond standard receipts/invoices.

**How it Works:**

1. Label key-value pairs or regions of interest in 5+ sample documents.
2. Upload them to Azure for model training.
3. Deploy the trained model to extract fields from similar document formats.

**Use Case:**

- Automating the extraction of custom fields in medical reports or contractual documents.

---

### **4️⃣ Key-Value Pair Extraction**

Identify structured **key-value pairs** in documents:

- Example: For forms with entries like `Name: John Doe` or `Total: $5000`, Azure Document Intelligence will map “Name” to “John Doe” and “Total” to “$5000.”

**Use Case:**

- Parsing employment forms or insurance claims to extract critical metadata for fast database population.

---

### **5️⃣ Table Recognition**

Azure Document Intelligence excels at recognizing **tables** in documents. For each table, it provides:

- Cell-level details (row and column position).
- Bounding box coordinates (for visual layouts).
- Proper differentiation between rows and columns.

**Use Case:**

- Extracting financial transactions from bank statements or dynamically processing tabular data in multi-page PDFs.

---

### **6️⃣ Image and Handwriting Recognition**

- Recognize printed and handwritten text in **scanned documents**, even if they’re photos. For instance:
    - Handwritten forms (medical prescriptions).
    - Scanned images of contracts or receipts.

**Use Case:**

- Digitizing hand-filled forms for automation pipelines using OCR **(Optical Character Recognition)** capabilities.

---

### **7️⃣ Multi-Language Support**

Supports data extraction from **documents written in multiple languages**. For global companies handling multilingual receipts, invoices, or agreements, this is invaluable.

---

### **8️⃣ Confidence Scores**

For every extraction, Azure provides a **confidence score** indicating the reliability of the data. This is helpful for auditing or identifying low-confidence fields for manual validation.

---

## **How Azure Document Intelligence Differs from Traditional PDF Parsers**

| **Feature** | **Traditional Parsing (e.g., PyPDF)** | **Azure Document Intelligence** |
| --- | --- | --- |
| **AI-Powered Understanding** | No | Yes |
| **Key-Value Pair Recognition** | No | Yes |
| **Prebuilt Models** | No | Yes (Invoices, Receipts, IDs, etc.) |
| **Handwriting Recognition** | Limited | Excellent |
| **Custom Training** | N/A | Fully Supported |
| **Multilingual Support** | No | Yes |
| **Tabular Data Recognition** | Very Limited | Robust with Bounding Boxes |

---

## **How Azure Document Intelligence Works**

Here’s how you can process a document using Azure:

1. **Upload Your Document** (through an API client or Azure portal).
2. **Select Prebuilt or Custom Models** (e.g., Invoice Model, Receipt Model, or a Custom-Trained Model).
3. **Use the AI Model to Extract Data**.
4. **Receive Parsed Output** in formats like JSON, including:
    - Extracted text.
    - Key-Value pairs.
    - Tabular data.

---

## **Code Example: Parsing an Invoice with Azure**

Below is an example of using **Azure SDK for Python** to extract data from an invoice.

### **Step 1: Install Azure’s Form Recognizer SDK**

```bash
pip install azure-ai-formrecognizer

```

### **Step 2: Use Prebuilt Invoice Model**

```python
from azure.core.credentials import AzureKeyCredential
from azure.ai.formrecognizer import DocumentAnalysisClient

# Azure credentials
endpoint = "https://<your-resource-name>.cognitiveservices.azure.com/"
key = "<your-key>"

# Initialize client
document_analysis_client = DocumentAnalysisClient(endpoint, AzureKeyCredential(key))

# Load your document
invoice_path = "path_to_invoice.pdf"
with open(invoice_path, "rb") as invoice:
    poller = document_analysis_client.begin_analyze_document("prebuilt-invoice", document=invoice)
    result = poller.result()

# Extract fields
for field, field_data in result.fields.items():
    print(f"{field}: {field_data.value} (Confidence: {field_data.confidence})")

```

### **Sample Output**

```
Vendor Name: ABC Corp. (Confidence: 0.97)
Invoice Date: August 11, 2025 (Confidence: 0.95)
Total Amount: $1450.50 (Confidence: 0.99)

```

---

## **Advanced Use Case: Custom Model Training**

### **1. Train a Custom Model in Azure Portal**

1. **Create a Labeling Project** in the Azure Form Recognizer Studio.
2. Upload 5+ samples of your document type (e.g., insurance claims).
3. Annotate fields you want the AI to extract (e.g., `Claim ID`, `Amount`, etc.).
4. Train and evaluate the model.

### **2. Use The Custom Model in Code**

```python
from azure.ai.formrecognizer import DocumentAnalysisClient

# Analyze the custom document
model_id = "<custom-model-id>"
with open("path_to_document.pdf", "rb") as doc:
    poller = document_analysis_client.begin_analyze_document(model_id, document=doc)
    result = poller.result()

# Output custom fields
for name, field in result.fields.items():
    print(f"{name}: {field.value} (Confidence: {field.confidence})")

```

### **Applications**

- Extract client-specific fields from contracts, agreements, or custom reports.

---

## **Advantages of Azure Document Intelligence**

- **Accuracy:** High-quality OCR and advanced AI-based parsing.
- **Versatility:** Suitable for structured (forms) and unstructured (paragraphs) documents.
- **Pretrained Models:** Save you the time and effort of building models for common documents.
- **Custom Models:** Adaptable to unique document types.
- **Scalability:** Handles large volumes via Azure’s cloud infrastructure.
- **Integration:** Seamlessly integrates with other Azure services (e.g., Azure Cognitive Search, Power Automate).

---

## **Disadvantages**

- **Cost:** Processing high volumes of documents incurs significant Azure charges.
- **Initial Complexity:** Setting up custom models can be time-consuming.
- **Dependency:** Requires internet/cloud connectivity and Azure-specific tools.

---

## **Use Case Examples**

1. **Invoice Processing Pipeline:**
    - Automatically extract totals, dates, and vendor information for accounting systems.
2. **SharePoint Chatbot with RAG:**
    - Parse and analyze SharePoint-hosted PDFs for chatbot responses.
3. **Legal Document Analysis:**
    - Extract metadata or key clauses from contracts for legal workflows.
4. **Expense Management System:**
    - Parse receipt PDFs into tabular data for approval workflows and reporting.

---

Azure Document Intelligence is a game-changer for businesses looking to automate and scale their document processing needs, whether you're building a simple pipeline or an intelligent, context-aware RAG system.