# 7. Hand off using Orchestrator Agent

Finally, we have the **Orchestrator Agent**. This is the brain of our multi-agent system. It doesn't perform specialized tasks directly but understands the user's overarching goal and delegates sub-tasks to the appropriate specialist agents. Its power comes from its ability to `handoff` control.

```python
# ===== Orchestrator Agent Definition =====
orchestrator_agent = Agent[UserInfo](
    name="Etex Orchestrator Agent", # The central coordinator
    instructions=orchestrator_instructions, # Its instructions for delegation and flow management
    model=OpenAIChatCompletionsModel(
        model=model_name,
        openai_client=agent_client
    ),
    # This is the crucial part: listing the agents it can hand off to
    handoffs=[
        handoff(image_specialist_agent), # The orchestrator can delegate to the Image Agent
        handoff(blog_writer_agent),     # The orchestrator can delegate to the Blog Writer Agent
    ],
    tools=[], # The orchestrator's primary 'tools' are its handoffs
)

# A simple function to retrieve the orchestrator agent for external use
def get_orchestrator_agent() -> Agent[UserInfo]:
    return orchestrator_agent
```

- **`name`**: "Etex Orchestrator Agent" clearly states its role as the system's central control.
- **`instructions`**: Loaded from `orchestrator_agent_instructions.md`, these instructions are paramount. They teach the orchestrator:
    - How to parse complex user requests.
    - When to identify the need for an image, a blog post, or a combination.
    - The criteria for deciding which specialist agent to `handoff` to.
    - How to potentially gather results from delegated tasks and synthesize a final response for the user.
- **`handoffs`**: This list is where you explicitly define which other `Agent` instances the orchestrator can transfer control to. Each `handoff(some_agent)` effectively creates a callable "tool" that, when triggered by the orchestrator's LLM, signals the agent framework to switch the active agent. This is how the delegation happens.
- **`tools`**: The orchestrator in this setup doesn't have direct tools, as its main function is to coordinate via handoffs. However, a more complex orchestrator might have general utility tools (e.g., a web search tool for initial information gathering).

---

### The Power of Collaboration

By building distinct, specialized agents and an orchestrator to manage their interactions, you create a robust and highly capable AI system. A user's complex request, such as "Generate a blog post about the future of AI with a creative image of AI and humans collaborating," can now be intelligently decomposed:

1. The `Etex Orchestrator Agent` receives the request.
2. It determines a blog post is needed and **hands off** to the `Blog Writer Agent`.
3. The `Blog Writer Agent` starts drafting. At some point (either through its own logic or another orchestrator decision), the need for an image arises.
4. The `Etex Orchestrator Agent` then **hands off** to the `Image & Media Creation Agent` with a specific image prompt.
5. The `Image & Media Creation Agent` generates the image using its tool.
6. The result (e.g., an image URL) is returned, and the flow returns to the `Blog Writer Agent` (or orchestrator) to incorporate the image into the blog post.
7. Finally, the complete blog post with the image reference is presented to the user.

This modularity not only enhances the system's ability to handle diverse and intricate tasks but also simplifies development, testing, and future expansion. You're no longer building a single AI giant, but a dynamic team of experts, ready to tackle any challenge.