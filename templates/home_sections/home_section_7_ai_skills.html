<div class="section-header-container">
      <div class="section-header">
            <div class="section-title">
                  <div class="section-text">AI & LLM Engineering</div>
            </div>
      </div>
</div>
<div class="ai-section-subtitle">
  <div class="ai-section-subtext">Click on any card to explore and read more about each topic.</div>
</div>
<div class="carousel-container">
      <div class="carousel-wrapper">
            <div class="carousel-track" id="carouselTrack">
                  <div class="carousel-card card-1">
                        <div class="card-image">
                              <img src="/static/thumbnails/gradients/IMG_4854.JPG" alt="Generative AI Icon" class="EXPERTISE-logo">
                        </div>
                        <div class="card-content">
                              <div class="card-title">RAG Systems</div>
                        </div>
                  </div>

                  <div class="carousel-card card-2">
                        <div class="card-image">
                              <img src="/static/thumbnails/gradients/IMG_4845.JPG" alt="Generative AI Icon" class="EXPERTISE-logo">
                        </div>
                        <div class="card-content">
                              <div class="card-title">Agent Orchestration</div>
                        </div>
                  </div>

                  <div class="carousel-card card-3">
                        <div class="card-image">
                              <img src="/static/thumbnails/gradients/IMG_4840.JPG" alt="Generative AI Icon" class="EXPERTISE-logo">
                        </div>
                        <div class="card-content">
                              <div class="card-title">Prompt Engineering</div>
                        </div>
                  </div>

                  <div class="carousel-card card-4">
                        <div class="card-image">
                              <img src="/static/thumbnails/gradients/IMG_4853.JPG" alt="Generative AI Icon" class="EXPERTISE-logo">
                        </div>
                        <div class="card-content">
                              <div class="card-title">Data Chunking</div>
                        </div>
                  </div>

                  <div class="carousel-card card-5">
                        <div class="card-image">
                              <img src="/static/thumbnails/gradients/IMG_4852.JPG" alt="Generative AI Icon" class="EXPERTISE-logo">
                        </div>
                        <div class="card-content">
                              <div class="card-title">Token Optimization</div>
                        </div>
                  </div>
            </div>
      </div>

      <div class="navigation">
            <button class="nav-button" id="prevBtn">
                  <img src="/static/images/lucidev-icons/chevron-left.svg"/>
            </button>
            <button class="nav-button" id="nextBtn">
                  <img src="/static/images/lucidev-icons/chevron-right.svg"/>
            </button>
      </div>

      <script>
            class Carousel {
                  constructor() {
                        this.track = document.getElementById("carouselTrack");
                        this.prevBtn = document.getElementById("prevBtn");
                        this.nextBtn = document.getElementById("nextBtn");
                        this.startAutoScrollBtn = null;
                        this.stopAutoScrollBtn = null;
                        this.cards = document.querySelectorAll(".carousel-card");

                        this.currentIndex = 0;
                        this.autoScrollInterval = null;
                        this.autoScrollDelay = 3000;
                        this.isAutoScrolling = true;

                        this.init();
                  }

                  getCardWidth() {
                        const card = this.cards[0];
                        const cardWidth = card.offsetWidth;
                        const gap = 20;
                        return cardWidth + gap;
                  }

                  getVisibleCards() {
                        const containerWidth = this.track.parentElement.offsetWidth - 40; // Account for padding
                        const cardWidth = this.getCardWidth();
                        return Math.floor(containerWidth / cardWidth);
                  }

                  getMaxIndex() {
                        const visibleCards = this.getVisibleCards();
                        return Math.max(0, this.cards.length - visibleCards);
                  }

                  init() {
                        this.updateCarousel();
                        this.bindEvents();
                        this.startAutoScroll();
                        window.addEventListener("resize", () => this.handleResize());
                  }

                  bindEvents() {
                        this.prevBtn.addEventListener("click", () => {
                              this.stopAutoScrollFunc();
                              this.prev();
                        });

                        this.nextBtn.addEventListener("click", () => {
                              this.stopAutoScrollFunc();
                              this.next();
                        });

                        this.startAutoScrollBtn?.addEventListener("click", () => this.startAutoScroll());
                        this.stopAutoScrollBtn?.addEventListener("click", () => this.stopAutoScrollFunc());

                        // Touch/swipe support
                        let startX = 0;
                        let currentX = 0;
                        let isDragging = false;

                        this.track.addEventListener("touchstart", (e) => {
                              startX = e.touches[0].clientX;
                              isDragging = true;
                              this.stopAutoScrollFunc();
                        });

                        this.track.addEventListener("touchmove", (e) => {
                              if (!isDragging) return;
                              currentX = e.touches[0].clientX;
                              e.preventDefault();
                        });

                        this.track.addEventListener("touchend", () => {
                              if (!isDragging) return;
                              const diff = startX - currentX;
                              if (Math.abs(diff) > 50) {
                                    if (diff > 0) {
                                          this.next();
                                    } else {
                                          this.prev();
                                    }
                              }
                              isDragging = false;
                        });

                        // Pause auto-scroll on hover
                        this.track.addEventListener("mouseenter", () => {
                              if (this.isAutoScrolling) {
                                    this.pauseAutoScroll();
                              }
                        });

                        this.track.addEventListener("mouseleave", () => {
                              if (this.isAutoScrolling) {
                                    this.resumeAutoScroll();
                              }
                        });
                  }

                  prev() {
                        if (this.currentIndex > 0) {
                              this.currentIndex--;
                        } else {
                              this.currentIndex = this.getMaxIndex();
                        }
                        this.updateCarousel();
                  }

                  next() {
                        const maxIndex = this.getMaxIndex();
                        if (this.currentIndex < maxIndex) {
                              this.currentIndex++;
                        } else {
                              this.currentIndex = 0;
                        }
                        this.updateCarousel();
                  }

                  updateCarousel() {
                        const cardWidth = this.getCardWidth();
                        const translateX = -this.currentIndex * cardWidth;
                        this.track.style.transform = `translateX(${translateX}px)`;

                        // Update navigation buttons
                        const maxIndex = this.getMaxIndex();
                        this.prevBtn.disabled = false;
                        this.nextBtn.disabled = false;
                  }

                  startAutoScroll() {
                        if (this.autoScrollInterval) {
                              clearInterval(this.autoScrollInterval);
                        }

                        this.autoScrollInterval = setInterval(() => {
                              this.next();
                        }, this.autoScrollDelay);

                        this.isAutoScrolling = true;
                        if (this.startAutoScrollBtn) {
                              this.startAutoScrollBtn.classList.add("active");
                              this.stopAutoScrollBtn.classList.remove("active");
                        }
                  }

                  stopAutoScrollFunc() {
                        if (this.autoScrollInterval) {
                              clearInterval(this.autoScrollInterval);
                              this.autoScrollInterval = null;
                        }

                        this.isAutoScrolling = false;
                        if (this.startAutoScrollBtn) {
                              this.startAutoScrollBtn.classList.remove("active");
                              this.stopAutoScrollBtn.classList.add("active");
                        }
                  }

                  pauseAutoScroll() {
                        if (this.autoScrollInterval) {
                              clearInterval(this.autoScrollInterval);
                              this.autoScrollInterval = null;
                        }
                  }

                  resumeAutoScroll() {
                        if (this.isAutoScrolling && !this.autoScrollInterval) {
                              this.autoScrollInterval = setInterval(() => {
                                    this.next();
                              }, this.autoScrollDelay);
                        }
                  }

                  handleResize() {
                        this.updateCarousel();
                  }
            }

            document.addEventListener("DOMContentLoaded", () => {
                  new Carousel();
            });
      </script>
</div>
